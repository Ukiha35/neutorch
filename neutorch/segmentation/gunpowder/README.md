the code is copied from [gunpowder](https://github.com/funkey/gunpowder) following MIT license